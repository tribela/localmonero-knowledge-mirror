---
title: "モネロでアトミックスワップがどのように機能するか"
slug: "monero-atomic-swaps"
date: "2020-11-18"
image: "/images/atomic.png"
image_credit: "Illustration by CypherStack"
image_credit_url: "https://cypherstack.com"
---
分散化と真に無許可のシステムを追求する中で、分散型取引所やアトミック スワップほど仮想通貨の分野で切望されているものはほとんどありません。モネロは当初から、プロトコルを設計しようとする際にプライバシー機能が固有の問題を引き起こすため、アトミック スワップの実装に苦労してきました。

でも、まずはバックアップしましょう。アトミックスワップとは？アトミック スワップは、異なるブロックチェーン上の 2 つの異なる暗号通貨を、仲介者なしでトラストレスな方法で交換できるプロトコルです。これは、誰かが暗号通貨 A を暗号通貨 B に交換したい場合、中央集権型または分散型の交換なしでそれを行うことができることを意味します。ご想像のとおり、これにはかなりの調査が必要であり、それを可能にする完全な技術的詳細は非常に複雑になります。繰り返しになりますが、LocalMonero は、一般の人に役立つ簡単な説明を提供するためにここにいます。

まず、Bitcoin で実装されているアトミック スワップの最も単純な形式を考えてみましょう。ビットコインを同じハッシュ タイム ロック コントラクト技術を使用する別のコインに交換したい場合は、次の方法で行うことができます。アリスはビットコイン (BTC) を持っていますがライトコイン (LTC) を欲しがり、ボブは LTC を持っていますが BTC を欲しがっています。彼らは、アトミックスワップを実行して、それぞれが必要なコインを取得することにしました。 アリスは自分の BTC を特別なアドレスに送信し、資金をロックしてアクセスできないようにするスクリプトを使用します。アリスが自分の BTC をロックボックスに入れるようなものと考えることができます。ロックボックスが作成されると、彼女はキーを取得し、このキーのハッシュをボブに送信します。現在、ボブはキー自体を持っておらず、ハッシュのみを持っているため、まだ資金にアクセスできません。

ボブはこのハッシュをシードとして使用し、そこから自分のロックボックスを生成し、LTC をそこに送信します。そこでもロックされます。 アリスの鍵のハッシュは、ボブのロックボックスが作成されたシードとして使用されたため、アリスは自分の鍵を使用して、ボブのロックボックスの LTC を要求できます。彼女の鍵が合う！しかし、数学の魔法を使って、彼女が自分のキーを使って LTC ロックを開くと、そのキーをボブに明かします。ボブはそれを使って、彼女がロックボックスに入れた BTC を受け取ることができます。このようにして、仲介者なしで、アリスとボブは資産の交換に成功しました。

しかし、ちょっとした問題があります。 アリスが自分のロックボックスに送金し、ボブがもう取引したくないと判断した場合はどうなるでしょうか。ここで、アリスはロックした BTC にアクセスできず、ボブは取引の一部を完了しないため、アリスはお金を永久に失うことになります。幸いなことに、ビットコインには払い戻しトランザクションと呼ばれる小さな技術があり、一定期間後、ボブが BTC を要求しない場合、スクリプトにはフェイルセーフが組み込まれており、BTC は自動的にアリスに戻されます。これは、Monero のアトミック スワップ実装の主要なスピードバンプでした。 Monero の [ リング署名プライバシー テクノロジー ](/knowledge/ring-signatures) により、トランザクションの送信者は常に不明です。トランザクションがどこから来たのかわからない場合でも、プロトコルはどのように返金トランザクションを行うことができますか?

2017 年、少数の研究者グループが、Monero でアトミック スワップが機能する別の方法を概説しました。数年にわたる改良の後、研究者は、モネロが返金取引なしでもビットコインとのアトミック スワップを実行できるプロセスを完成させました。

このレベルの技術的複雑さの多くのものと同様に、アイデアを伝えるためにいくつかのことを過度に単純化して説明しますが、それでもこのプロセスが機能するメカニズムの確かなアイデアを提供します。

アリス (XMR を持っていて BTC を欲しがっている) とボブ (BTC を持っていて XMR を欲しがっている) の両方が、アトミックスワップをサポートするプログラムをダウンロードして実行する必要があります。これは、ウォレット、分散型取引所、または特別な特定のプログラムに実装される場合がありますが、ソフトウェアはアトミック スワップ プロトコルを実行している必要があります。最初のステップでは、アリスとボブのクライアントが相互に接続し、いくつかの共有シークレットとキーを作成します。このステップでは、新しい Monero アドレスが作成され、アリスがキーの半分を持ち、ボブが残りの半分を持ちます。ただし、Moneroはまだ入っていないので、使うものはありません。このアドレスについて最後に注意すべき点は、どちらもこのウォレットのビュー キーを持っているため、Monero が到着するかどうか、またはいつ到着するかを確認できることです。

2 番目のステップで、ボブは BTC を特別なアドレスに送信します。これは、既に説明したビットコイン アトミック スワップ プロトコルと同様です。アリスは、BTC がブロックチェーン上のこのアドレスに到着するのを確認した後、彼女とボブの両方が鍵の半分を持っている Monero アドレスに Monero を送信します。ボブはビュー キーも持っているため、モネロが到着したことを確認できます。モネロが安全にウォレットにあることを確認したら、ビットコインを引き出すためのキーの一部をアリスに送信します。他のプロトコルと同様に、ビットコインを要求するプロセスは、Monero キーの彼女の半分をボブに明らかにします。ボブは両方の半分を持っているので、彼はモネロを請求できますが、アリスは自分の半分しか持っていないので、彼より先にそれを取ろうとすることはできません。

これらすべてを見て、モネロがどのようにして返金取引の問題を回避できたのかまだ少し混乱している場合、答えは非常に簡単です。 Monero自体には払い戻しトランザクションがないため、読者は、Bitcoin (払い戻しトランザクションがある) が最初に送信され、ブロックチェーン上にあることが確認された後にのみ Moneroが送信されることに注意してください。これにより、モネロはビットコインの機能を利用して払い戻しトランザクションをスクリプト化し、これらの機能自体を必要とせずにそれらを利用することができます。

アトミック スワップはこれで完了しましたが、ここから、ボブには新しく要求された XMR に対していくつかのオプションがあります。この Monero ウォレットをそのまま使用するか、XMR を既に所有している別のウォレットに移動できます。ボブはモネロを別のウォレットに移動する可能性が高い。アリスはまだビューキーを持っており、内部を見ることができる。

このプロトコルの優れた点は、まだ非常に新しく、最適化の余地が十分にあることです。また、アーキテクチャが非常に柔軟であるため、他のウォレットや分散型取引所での実装はシンプルで、既存のアーキテクチャにきれいに適合する必要があります。

参考文献